# TrustedBusinessReviews.com — Malware Scan Findings
## Date: 2026-02-14

## Summary
The site has **multiple layers of active malware** across at least 7 infected files, plus unauthorized SSH keys. This is a sophisticated, multi-vector compromise.

---

## INFECTED FILES

### 1. `/index.php` (Root) — SEO Spam Doorway + Bot Redirect
- **Two separate malware payloads prepended** before the legitimate WordPress loader
- **Payload 1**: Japanese SEO spam doorway — detects search engine bots (Google, Bing, Yahoo) and serves spam pages from external server `65.21.235.251`, creating doorway pages in an `index/` subdirectory. Creates `google-site-verification` files to claim ownership.
- **Payload 2**: Bot detection — checks User-Agent for Google/Bing/Yahoo and fetches content from `65.108.10.199` to inject into search results
- **C2 servers**: `65.21.235.251`, `65.108.10.199`, obfuscated domain via `jan47.tphu5583htr` (decoded)

### 2. `/wp-content/themes/wprs-black/functions.php` — RCE Backdoor + Credential Exfiltration + Update Suppression
- **Credential Exfiltration**: Sends admin credentials and full request data to `information.cloudsyndication.dev` via POST
- **Remote Code Execution**: Full RCE backdoor triggered by specific cookie/request values:
  - Shell command execution via `proc_open`, `exec`, `passthru`, `system`, `shell_exec`
  - Arbitrary PHP eval
  - Remote file download to arbitrary paths
  - cURL proxy for SSRF attacks
- **Update Suppression**: Disables all WordPress plugin and theme auto-updates
- **Authentication cookies**: `1b2eeffa6f08a11898ca22caa22ebaa4` = `2408bd53d38802958e0dd1fe954682a6`
- **Admin tracking**: Injects localStorage/sessionStorage `is_admin=true` marker

### 3. `/wp-content/themes/CityDirectoryTheme/.cache.jpg` — Theme Infection Propagator
- **NOT an image** — full PHP script disguised as .jpg
- Recursively scans ALL WordPress theme `header.php` files across the entire server
- Injects a dropper that downloads and executes `wordpress.gif` from `wplogo.files.wordpress.com` (which was likely previously compromised or used for staging)
- Self-propagating — infects all themes on any server it runs on

### 4. `/wp-content/themes/wprs-black/header.php` — Dropper (injected by .cache.jpg)
- Contains dropper code at bottom that downloads `wordpress.gif` from wplogo.files.wordpress.com
- Executes the downloaded payload via `include_once`

### 5. `/wp-content/themes/CityDirectoryTheme/wordpress.gif` — Dead Payload
- Currently returns a WordPress.com 404 page (the staging URL is dead)
- Was previously the payload delivered by the dropper in header.php and .cache.jpg

### 6. `/e146a/index.php` — Obfuscated Remote Code Loader
- Heavily obfuscated PHP using goto-based control flow
- Constructs a URL string (reversed, hex-encoded) and fetches remote PHP code
- Executes fetched code via `eval`

### 7. `/et0lipze/index.php` — SEO Spam Doorway
- Full doorway page system for search engine spam
- Detects Google/Bing/Yahoo referrers and redirects to `65.108.10.199`
- Serves cached spam pages from `index/` subdirectory
- Fetches content from `65.109.67.100` using multiple methods (curl, file_get_contents, fsockopen)
- Password-protected: `visdoijew` + `b23hr23vr32` + `rv32ydacsvsdv`

### 8. `/.ssh/authorized_keys` — Unauthorized SSH Access
- Contains 2 SSH public keys (RSA + Ed25519) giving attackers direct shell access
- This is likely how the initial compromise was maintained

---

## CLEAN FILES (Verified)
- `/wp-content/themes/CityDirectoryTheme/functions.php` — CLEAN (legitimate theme code only)
- `/wp-content/themes/CityDirectoryTheme/_comments.php` — CLEAN (standard WP comments template)
- `/wp-content/themes/CityDirectoryTheme/_single.php` — CLEAN (standard WP single template)
- `/wp-content/themes/CityDirectoryTheme/header.php` — CLEAN (no injected code, uses Ahrefs analytics)
- `/wp-content/themes/CityDirectoryTheme/footer.php` — CLEAN
- `/wp-content/themes/wprs-black/header.php` — INFECTED (see #4 above)

---

## ATTACKER INFRASTRUCTURE
| Asset | Purpose |
|-------|---------|
| `information.cloudsyndication.dev` | Credential exfiltration C2 |
| `65.21.235.251` | SEO spam content server |
| `65.108.10.199` | SEO spam redirect/content server |
| `65.109.67.100` | SEO spam content server |
| `wplogo.files.wordpress.com` | Malware staging (disguised as WordPress logo) |
| 2 SSH public keys | Persistent server access |

---

## CLEANUP ACTIONS REQUIRED
1. ✅ Delete `/e146a/` directory entirely
2. ✅ Delete `/et0lipze/` directory entirely  
3. ✅ Clean `/index.php` — remove all malware, keep only legitimate WP loader
4. ✅ Clean `/wp-content/themes/wprs-black/functions.php` — remove all malware, keep legitimate theme code
5. ✅ Delete `/wp-content/themes/CityDirectoryTheme/.cache.jpg`
6. ✅ Delete `/wp-content/themes/CityDirectoryTheme/wordpress.gif`
7. ✅ Clean `/wp-content/themes/wprs-black/header.php` — remove dropper code
8. ✅ Remove unauthorized SSH keys from `/.ssh/authorized_keys`
